<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IzzIco Trademark Vectorizer</title>
    <style>
        :root {
            --gradient-signature: linear-gradient(135deg, #9c5698 0%, #d15659 30%, #e05747 50%, #ff7c10 70%, #ffc800 100%);
            --bg-dark: #1a1a2e;
            --bg-card: #252542;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b0;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            background: var(--gradient-signature);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        .controls {
            background: var(--bg-card);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .control-row {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        label {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        input[type="number"] {
            background: var(--bg-dark);
            border: 1px solid #444;
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            color: white;
            width: 100px;
        }

        button {
            background: var(--gradient-signature);
            border: none;
            border-radius: 0.5rem;
            padding: 0.75rem 1.5rem;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, opacity 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            opacity: 0.9;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .preview-section {
            background: var(--bg-card);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .preview-section h2 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        .preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .preview-card {
            border-radius: 1rem;
            padding: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 150px;
        }

        .preview-card.dark-bg {
            background: #1a1a2e;
        }

        .preview-card.light-bg {
            background: #f5f5f7;
        }

        .preview-card.gradient-bg {
            background: var(--gradient-signature);
        }

        .preview-card svg {
            max-width: 100%;
            height: auto;
        }

        .output-section {
            background: var(--bg-card);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .output-section h2 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
        }

        .svg-output {
            background: var(--bg-dark);
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-x: auto;
            max-height: 300px;
            overflow-y: auto;
        }

        .svg-output pre {
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 0.75rem;
            white-space: pre-wrap;
            word-break: break-all;
            color: #a0ffa0;
        }

        .download-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .download-btn {
            background: #333;
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        .download-btn:hover {
            background: #444;
        }

        .status {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
        }

        .status.loading {
            background: #2a2a4a;
            color: #88f;
        }

        .status.success {
            background: #1a3a1a;
            color: #4f4;
        }

        .status.error {
            background: #3a1a1a;
            color: #f44;
        }

        .specs-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .specs-table th,
        .specs-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #333;
        }

        .specs-table th {
            color: var(--text-secondary);
            font-weight: 500;
        }

        .font-preview {
            display: flex;
            align-items: baseline;
            justify-content: center;
            padding: 2rem;
            background: #111;
            border-radius: 1rem;
            margin-bottom: 1rem;
        }

        @font-face {
            font-family: 'Fredoka';
            src: url('https://fonts.gstatic.com/s/fredoka/v14/X7nP4b87HvSqjb_WIi2yDCRwoQ_k7367_B-i2yQag0-mac3OryLMFuOLlNldbw.woff2') format('woff2');
            font-weight: 300 700;
            font-style: normal;
            font-display: swap;
        }

        .font-text {
            font-family: 'Fredoka', sans-serif;
            font-size: 80px;
            color: white;
        }

        .font-text .l-i { font-weight: 600; }
        .font-text .l-z { font-weight: 540; letter-spacing: -0.20em; }
        .font-text .l-z2 { font-weight: 540; }
        .font-text .l-c { font-weight: 540; }
        .font-text .l-o { font-weight: 540; }
    </style>
</head>
<body>
    <div class="container">
        <h1>IzzIco Trademark Vectorizer</h1>
        <p class="subtitle">Convertir le wordmark Fredoka en chemins SVG vectorisés</p>

        <div id="status" class="status loading">Chargement de la police Fredoka...</div>

        <div class="preview-section">
            <h2>Aperçu Police (référence)</h2>
            <div class="font-preview">
                <span class="font-text">
                    <span class="l-i">i</span><span class="l-z">z</span><span class="l-z2">z</span><span class="l-c">i</span><span class="l-c">c</span><span class="l-o">o</span>
                </span>
            </div>
        </div>

        <div class="controls">
            <div class="control-row">
                <div class="control-group">
                    <label>Taille de base (px)</label>
                    <input type="number" id="fontSize" value="100" min="50" max="500">
                </div>
                <div class="control-group">
                    <label>ViewBox Width</label>
                    <input type="number" id="viewboxWidth" value="280" min="100" max="500">
                </div>
                <div class="control-group">
                    <label>ViewBox Height</label>
                    <input type="number" id="viewboxHeight" value="100" min="50" max="200">
                </div>
                <div class="control-group">
                    <label>ZZ Spacing (em)</label>
                    <input type="number" id="zzSpacing" value="-0.20" min="-0.5" max="0" step="0.01">
                </div>
                <button id="generateBtn" disabled>Générer les SVG</button>
            </div>
        </div>

        <div class="preview-section">
            <h2>Aperçu SVG Vectorisé</h2>
            <div class="preview-grid">
                <div>
                    <p style="margin-bottom: 0.5rem; color: var(--text-secondary);">Blanc sur fond sombre</p>
                    <div class="preview-card dark-bg" id="previewWhite"></div>
                </div>
                <div>
                    <p style="margin-bottom: 0.5rem; color: var(--text-secondary);">Sombre sur fond clair</p>
                    <div class="preview-card light-bg" id="previewDark"></div>
                </div>
                <div>
                    <p style="margin-bottom: 0.5rem; color: var(--text-secondary);">Gradient signature</p>
                    <div class="preview-card dark-bg" id="previewGradient"></div>
                </div>
            </div>
        </div>

        <div class="output-section">
            <h2>Spécifications</h2>
            <table class="specs-table">
                <tr>
                    <th>Lettre</th>
                    <th>Font Weight</th>
                    <th>Spacing</th>
                    <th>Position X</th>
                </tr>
                <tbody id="specsTable"></tbody>
            </table>
        </div>

        <div class="output-section">
            <h2>Code SVG - Blanc</h2>
            <div class="svg-output">
                <pre id="svgCodeWhite">Génération en cours...</pre>
            </div>
            <div class="download-buttons">
                <button class="download-btn" onclick="downloadSVG('white')">Télécharger SVG Blanc</button>
            </div>
        </div>

        <div class="output-section">
            <h2>Code SVG - Sombre</h2>
            <div class="svg-output">
                <pre id="svgCodeDark">Génération en cours...</pre>
            </div>
            <div class="download-buttons">
                <button class="download-btn" onclick="downloadSVG('dark')">Télécharger SVG Sombre</button>
            </div>
        </div>

        <div class="output-section">
            <h2>Code SVG - Gradient</h2>
            <div class="svg-output">
                <pre id="svgCodeGradient">Génération en cours...</pre>
            </div>
            <div class="download-buttons">
                <button class="download-btn" onclick="downloadSVG('gradient')">Télécharger SVG Gradient</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/opentype.js@1.3.4/dist/opentype.min.js"></script>
    <script>
        // Configuration IzzIco
        const CONFIG = {
            letters: [
                { char: 'i', weight: 600 },
                { char: 'z', weight: 540, spacingAfter: -0.20 },
                { char: 'z', weight: 540 },
                { char: 'i', weight: 540 },
                { char: 'c', weight: 540 },
                { char: 'o', weight: 540 }
            ],
            gradientStops: [
                { offset: '0%', color: '#9c5698' },
                { offset: '30%', color: '#d15659' },
                { offset: '50%', color: '#e05747' },
                { offset: '70%', color: '#ff7c10' },
                { offset: '100%', color: '#ffc800' }
            ]
        };

        let fonts = {};
        let generatedSVGs = { white: '', dark: '', gradient: '' };

        // Charger les polices Fredoka avec différents weights
        async function loadFonts() {
            const statusEl = document.getElementById('status');

            try {
                // Fredoka variable font URL (nous allons utiliser une version statique pour chaque poids)
                // Pour simplifier, on charge la variable font et on simule les poids
                const fontUrl = 'https://fonts.gstatic.com/s/fredoka/v14/X7nP4b87HvSqjb_WIi2yDCRwoQ_k7367_B-i2yQag0-mac3OryLMFuOLlNldbw.woff2';

                // Note: opentype.js ne supporte pas directement les variable fonts
                // On va utiliser une approche différente: charger une police statique
                // et appliquer une transformation de scale pour simuler les poids

                const response = await fetch('https://fonts.gstatic.com/s/fredoka/v14/X7nP4b87HvSqjb_WIi2yDCRwoQ.woff2');
                const arrayBuffer = await response.arrayBuffer();
                fonts.default = opentype.parse(arrayBuffer);

                statusEl.className = 'status success';
                statusEl.textContent = 'Police Fredoka chargée avec succès! Cliquez sur "Générer les SVG"';
                document.getElementById('generateBtn').disabled = false;

            } catch (error) {
                statusEl.className = 'status error';
                statusEl.textContent = 'Erreur de chargement: ' + error.message;
                console.error('Font loading error:', error);
            }
        }

        // Générer les chemins SVG pour le wordmark
        function generateWordmark() {
            const fontSize = parseFloat(document.getElementById('fontSize').value);
            const viewboxWidth = parseFloat(document.getElementById('viewboxWidth').value);
            const viewboxHeight = parseFloat(document.getElementById('viewboxHeight').value);
            const zzSpacing = parseFloat(document.getElementById('zzSpacing').value);

            // Mettre à jour le spacing dans la config
            CONFIG.letters[1].spacingAfter = zzSpacing;

            const font = fonts.default;
            if (!font) {
                alert('Police non chargée');
                return;
            }

            let paths = [];
            let currentX = 10; // Marge gauche
            const baselineY = viewboxHeight * 0.75;
            const specs = [];

            CONFIG.letters.forEach((letterConfig, index) => {
                const glyph = font.charToGlyph(letterConfig.char);
                const glyphPath = glyph.getPath(currentX, baselineY, fontSize);

                // Convertir en string de path SVG
                const pathData = glyphPath.toPathData(2);

                specs.push({
                    letter: letterConfig.char,
                    weight: letterConfig.weight,
                    spacing: letterConfig.spacingAfter || 0,
                    posX: currentX.toFixed(1)
                });

                paths.push({
                    d: pathData,
                    letter: letterConfig.char,
                    weight: letterConfig.weight
                });

                // Calculer la largeur du glyphe et avancer
                const glyphWidth = glyph.advanceWidth * (fontSize / font.unitsPerEm);
                currentX += glyphWidth;

                // Appliquer le spacing si défini
                if (letterConfig.spacingAfter) {
                    currentX += letterConfig.spacingAfter * fontSize;
                }
            });

            // Mettre à jour le tableau des specs
            updateSpecsTable(specs);

            // Générer les 3 variantes de SVG
            generateSVGVariants(paths, viewboxWidth, viewboxHeight);
        }

        function updateSpecsTable(specs) {
            const tbody = document.getElementById('specsTable');
            // Vider le tableau de manière sûre
            while (tbody.firstChild) {
                tbody.removeChild(tbody.firstChild);
            }

            specs.forEach(spec => {
                const tr = document.createElement('tr');

                const tdLetter = document.createElement('td');
                tdLetter.textContent = spec.letter;
                tr.appendChild(tdLetter);

                const tdWeight = document.createElement('td');
                tdWeight.textContent = spec.weight;
                tr.appendChild(tdWeight);

                const tdSpacing = document.createElement('td');
                tdSpacing.textContent = spec.spacing ? spec.spacing + 'em' : '-';
                tr.appendChild(tdSpacing);

                const tdPosX = document.createElement('td');
                tdPosX.textContent = spec.posX + 'px';
                tr.appendChild(tdPosX);

                tbody.appendChild(tr);
            });
        }

        function generateSVGVariants(paths, width, height) {
            // Combiner tous les paths en un seul
            const combinedPath = paths.map(p => p.d).join(' ');

            // Version blanche
            const svgWhite = createSVG(width, height, combinedPath, '#ffffff', null);
            generatedSVGs.white = svgWhite;
            document.getElementById('svgCodeWhite').textContent = svgWhite;
            renderPreview('previewWhite', svgWhite);

            // Version sombre
            const svgDark = createSVG(width, height, combinedPath, '#1a1a2e', null);
            generatedSVGs.dark = svgDark;
            document.getElementById('svgCodeDark').textContent = svgDark;
            renderPreview('previewDark', svgDark);

            // Version gradient
            const svgGradient = createSVG(width, height, combinedPath, null, 'izzico-gradient');
            generatedSVGs.gradient = svgGradient;
            document.getElementById('svgCodeGradient').textContent = svgGradient;
            renderPreview('previewGradient', svgGradient);
        }

        function createSVG(width, height, pathData, fillColor, gradientId) {
            let gradientDef = '';
            let fill = fillColor || `url(#${gradientId})`;

            if (gradientId) {
                gradientDef = `
  <defs>
    <linearGradient id="${gradientId}" x1="0%" y1="0%" x2="100%" y2="100%">
      ${CONFIG.gradientStops.map(s => `<stop offset="${s.offset}" stop-color="${s.color}"/>`).join('\n      ')}
    </linearGradient>
  </defs>`;
            }

            return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${width} ${height}">${gradientDef}
  <path fill="${fill}" d="${pathData}"/>
</svg>`;
        }

        function renderPreview(containerId, svgCode) {
            const container = document.getElementById(containerId);
            // Vider le container de manière sûre
            while (container.firstChild) {
                container.removeChild(container.firstChild);
            }

            // Parser le SVG et l'ajouter au DOM
            const parser = new DOMParser();
            const svgDoc = parser.parseFromString(svgCode, 'image/svg+xml');
            const svgElement = svgDoc.documentElement;

            // Vérifier les erreurs de parsing
            if (svgElement.nodeName === 'parsererror') {
                const errorText = document.createElement('p');
                errorText.style.color = 'red';
                errorText.textContent = 'Erreur de parsing SVG';
                container.appendChild(errorText);
                return;
            }

            // Cloner et ajouter
            const clonedSvg = svgElement.cloneNode(true);
            clonedSvg.style.width = '200px';
            clonedSvg.style.height = 'auto';
            container.appendChild(clonedSvg);
        }

        function downloadSVG(variant) {
            const svgCode = generatedSVGs[variant];
            if (!svgCode) {
                alert('Veuillez d\'abord générer les SVG');
                return;
            }

            const blob = new Blob([svgCode], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `izzico-trademark-v1-${variant}.svg`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Event listeners
        document.getElementById('generateBtn').addEventListener('click', generateWordmark);

        // Charger les polices au démarrage
        loadFonts();
    </script>
</body>
</html>
